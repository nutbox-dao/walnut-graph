specVersion: 0.0.2
schema:
  file: ./schema.graphql
dataSources:
  - kind: ethereum/contract
    name: Committee
    network: shibuya
    source:
      address: "0x3931546cA5399ef0e0b0c7d1d78C89F0e7BeB8AF"
      abi: Committee
      startBlock: 1512267
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.5
      language: wasm/assemblyscript
      entities:
        - Walnut
        - FeeHistory
        - AppropriationHistory
      abis:
        - name: Committee
          file: ./abis/Committee.json
      eventHandlers:
        - event: "NewRevenue(string,indexed address,indexed address,indexed address,uint256)"
          handler: handleNewRevenue
        - event: "NewAppropriation(address,uint256)"
          handler: handleNewAppropriation
      file: ./src/mappingCommittee.ts
  - kind: ethereum/contract
    name: CommunityFactory
    network: shibuya
    source:
      address: "0x6B70dCfA3E14f532C8C9cB113558254464760023"
      abi: CommunityFactory
      startBlock: 1512267
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.5
      language: wasm/assemblyscript
      entities:
        - Community
        - CommunityManageHistory
      abis:
        - name: CommunityFactory
          file: ./abis/CommunityFactory.json
      eventHandlers:
        - event: "CommunityCreated(indexed address,indexed address,address)"
          handler: handleCommunityCreated
      file: ./src/mappingCommunityFactory.ts
  - kind: ethereum/contract
    name: ERC20StakingFactory
    network: shibuya
    source:
      address: "0xF46ddB1Cb72e648138bc902d5D0E984444dC83c5"
      abi: ERC20StakingFactory
      startBlock: 1512267
    mapping:
      kind: ethereum/contract
      apiVersion: 0.0.5
      language: wasm/assemblyscript
      entities:
        - Pool
      abis:
        - name: ERC20StakingFactory
          file: ./abis/ERC20StakingFactory.json
      eventHandlers:
        - event: "ERC20StakingCreated(indexed address,indexed address,string,address)"
          handler: handleERC20StakingCreated
      file: ./src/mappingERC20StakingFactory.ts
  - kind: ethereum/contract
    name: CrowdloanFactory
    network: shibuya
    source:
      address: "0x5F75409D6BB35D382eF11aaD614EE107ec6FE77f"
      abi: CrowdloanFactory
      startBlock: 1512267
    mapping:
      kind: ethereum/contract
      apiVersion: 0.0.5
      language: wasm/assemblyscript
      entities:
        - Pool
      abis:
        - name: CrowdloanFactory
          file: ./abis/CrowdloanFactory.json
      eventHandlers:
        - event: "CrowdloanCreated(indexed address,indexed address,string,uint8,uint256,uint256)"
          handler: handleCrowdloanCreated
      file: ./src/mappingCrowdloanFactory.ts
  - kind: ethereum/contract
    name: AstarDappStakingFactory
    network: shibuya
    source:
      address: "0x2715aaeF6294BCCa56A86273114583500CA47363"
      abi: AstarDappStakingFactory
      startBlock: 1512267
    mapping:
      kind: ethereum/contract
      apiVersion: 0.0.5
      language: wasm/assemblyscript
      entities:
        - Pool
      abis:
        - name: AstarDappStakingFactory
          file: ./abis/AstarDappStakingFactory.json
      eventHandlers:
        - event: "AStarDappStakingCreated(indexed address,indexed address,string,address)"
          handler: handleAStarDappStakingCreated
      file: ./src/mappingAstarDappStakingFactory.ts
templates:
  - name: CommunityTemplate
    kind: ethereum/contract
    network: shibuya
    source:
      abi: Community
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.5
      language: wasm/assemblyscript
      entities:
        - Community
        - CommunityManageHistory
      abis:
        - name: Community
          file: ./abis/Community.json
      eventHandlers:
        - event: "AdminSetFeeRatio(uint16)"
          handler: handleAdminSetFeeRatio
        - event: AdminSetPoolRatio(address[],uint16[])
          handler: handleAdminSetPoolRatio
        - event: "PoolUpdated(indexed address,uint256)"
          handler: handlePoolUpdated
        - event: "AdminClosePool(indexed address)"
          handler: handleAdminClosePool
        - event: "WithdrawRewards(address[],indexed address,uint256)"
          handler: handleWithdrawRewards
        - event: "OwnershipTransferred(indexed address,indexed address)"
          handler: handleOwnershipTransferred
        - event: "DevChanged(indexed address,indexed address)"
          handler: handleDevChanged
        - event: "RevenueWithdrawn(indexed address,uint256)"
          handler: handleRevenueWithdrawn
      file: ./src/mappingCommunity.ts
  - name: ERC20StakingTemplate
    kind: ethereum/contract
    network: shibuya
    source:
      abi: ERC20Staking
    mapping:
      kind: ethereum/contract
      apiVersion: 0.0.5
      language: wasm/assemblyscript
      entities:
        - Pool
        - User
        - UserOperationHistory
      abis: 
        - name: ERC20Staking
          file: ./abis/ERC20Staking.json
      eventHandlers:
        - event: Deposited(indexed address,indexed address,uint256)
          handler: handleDeposited
        - event: Withdrawn(indexed address,indexed address,uint256)
          handler: handleWithdrawn
      file: ./src/mappingERC20Staking.ts
  - name: CrowdloanTemplate
    kind: ethereum/contract
    network: shibuya
    source:
      abi: Crowdloan
    mapping:
      kind: ethereum/contract
      apiVersion: 0.0.5
      language: wasm/assemblyscript
      entities:
        - Pool
        - User
        - UserOperationHistory
      abis: 
        - name: Crowdloan
          file: ./abis/Crowdloan.json
      eventHandlers:
        - event: Contributed(indexed address,indexed address,uint256,uint256)
          handler: handleContributed
      file: ./src/mappingCrowdloan.ts
  - name: AstarDappStakingTemplate
    kind: ethereum/contract
    network: shibuya
    source:
      abi: AstarDappStaking
    mapping:
      kind: ethereum/contract
      apiVersion: 0.0.5
      language: wasm/assemblyscript
      entities:
        - Pool
        - User
        - UserOperationHistory
      abis: 
        - name: AstarDappStaking
          file: ./abis/AstarDappStaking.json
      eventHandlers:
        - event: Staked(indexed address,indexed address,uint256)
          handler: handleStaked
        - event: UnStaked(indexed address,indexed address,uint256)
          handler: handleUnStaked
        - event: Withdraw(indexed address,indexed address,uint256)
          handler: handleWithdraw
        - event: StakeClaimed(indexed address,indexed address,uint256)
          handler: handleStakeClaimed
      file: ./src/mappingAstarDappStaking.ts